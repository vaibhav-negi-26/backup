<!DOCTYPE html>
<html lang="en">

<head>
	<title>Mile Partner</title>
	<!--== META TAGS ==-->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<!-- FAV ICON -->
	<link rel="shortcut icon" href="images/fav.ico">
	<!-- FONT-AWESOME ICON CSS -->
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<!--== ALL CSS FILES ==-->
	<link rel="stylesheet" href="css/bus.css">
	<link rel="stylesheet" href="css/animate.css">
	<link rel="stylesheet" href="css/datepicker.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
	<style>
		/* loader */
		.wrapper{
			width: 100%;
			height: 80vh;
			margin:0;
			padding: 0;
			display: flex;
			justify-content: center;
			align-items: center;
		}
		.wrapper h1{
			text-shadow:1px 1px crimson;
			font-size: 3.5rem;
		}
		.loader {
			border: 16px solid #3498db;
			border-radius: 50%;
			border-top: 16px solid crimson;
			width: 120px;
			height: 120px;
			-webkit-animation: spin 2s linear infinite; /* Safari */
			animation: spin 2s linear infinite;
		}
		
		/* Safari */
		@-webkit-keyframes spin {
			0% { -webkit-transform: rotate(0deg); }
			100% { -webkit-transform: rotate(360deg); }
		}
		
		@keyframes spin {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		}

		/* moadal */
		.form-elegant .font-small {
			font-size: 0.8rem;
		}

		.form-elegant .z-depth-1a {
			-webkit-box-shadow: 0 2px 5px 0 rgba(55, 161, 255, 0.26), 0 4px 12px 0 rgba(121, 155, 254, 0.25);
			box-shadow: 0 2px 5px 0 rgba(55, 161, 255, 0.26), 0 4px 12px 0 rgba(121, 155, 254, 0.25);
		}

		.form-elegant .z-depth-1-half,
		.form-elegant .btn:hover {
			-webkit-box-shadow: 0 5px 11px 0 rgba(85, 182, 255, 0.28), 0 4px 15px 0 rgba(36, 133, 255, 0.15);
			box-shadow: 0 5px 11px 0 rgba(85, 182, 255, 0.28), 0 4px 15px 0 rgba(36, 133, 255, 0.15);
		}

		.form-elegant .modal-header {
			border-bottom: none;
		}

		.modal-dialog .form-elegant .btn .fab {
			color: #2196f3 !important;
		}

		.form-elegant .modal-body,
		.form-elegant .modal-footer {
			font-weight: 400;
		}

		.blue-gradient {
			color: white;
			background: linear-gradient(to right, rgb(36, 141, 202), rgb(56, 63, 197));
			text-transform: uppercase;
			border-radius: 50px !important;
		}

		.blue-gradient:hover {
			background: linear-gradient(to right, rgb(56, 63, 197), rgb(36, 141, 202));
		}

		.btn-white {
			background-color: #ffffff !important;
			color: #2196f3 !important;
			border-radius: 50px !important;
		}

		.md-form input {
			border: none;
			border-bottom: 1px solid #2196f3 !important;
			border-radius: 0px !important;
			color: #2196f3 !important;
		}
	</style>
</head>

<body ng-app="myApp" ng-controller="myCtrl">
	<!-- NAVBAR-->
	<nav class="navbar navbar-expand-lg navbar-light shadow-sm" style="background-color: #ffffff !important;">
		<div class="container">
			<a href="index.html" class="navbar-brand">
				<!-- Logo Image -->
				<img src="images/logo_org.png" width="110px" alt="" class="d-inline-block align-middle">

			</a>
			<button type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
				aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"
				class="navbar-toggler"><span class="navbar-toggler-icon"></span></button>

			<div id="navbarSupportedContent" class="collapse navbar-collapse">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
					<li class="nav-item"><a href="print-cancel.html" class="nav-link">Print/Cancel Ticket</a></li>
					<li class="nav-item"><a href="#" class="nav-link"></a></li>
					<li class="nav-item"><a href="#" class="nav-link">Contact us</a></li>
				</ul>
			</div>
		</div>
	</nav>		
	<!-- Main content -->
	<div class="container-fluid">
		<div class="row wrapper" id="loader_part">
			<div class="loader"></div>
		</div>
		<div class="row p-2" id="list_part">
			<div class="col-md-9" style="padding-right: 0px !important;">
				<!-- filter -->
				<div class="container-fluid">
					<div class="row text-center filter mt-3 animated fadeIn">
						<div class="col-md-4">
							<button type="button" class="btn btn-danger"> <i class="fa fa-arrow-left"
									aria-hidden="true"></i> Prev. Day</button>
						</div>
						<div class="col-md-4">
							<div class="input-field date">
								<input type="text" class="px-5" id="to" name="departuredate"
									placeholder="Date (yy-mm-dd)">
								<label for="to"></label>
							</div>
						</div>
						<div class="col-md-4">
							<button type="button" class="btn btn-danger">Next Day <i class="fa fa-arrow-right"
									aria-hidden="true"></i></button>
						</div>
					</div>
				</div>
				<!-- filter end -->
				<div class="pt-4 pb-5 wow fadeInUp" data-wow-duration="0.7s">
					<div class=" rounded shadow m-2">
						<!-- Rounded tabs -->
						<ul id="myTab" role="tablist"
							class="nav nav-tabs nav-pills flex-column flex-sm-row justify-content-around border-0 rounded-nav animated fadeInUp">
							<li class="nav-item flex-sm-fill">
								<a id="private-tab" data-toggle="tab" href="#private" role="tab" aria-controls="private"
									aria-selected="true"
									class="my_btn nav-link border-0 text-uppercase font-weight-bold active">Private
									Bus</a>
							</li>
							<li class="nav-item flex-sm-fill">
								<a id="government-tab" data-toggle="tab" href="#government" role="tab"
									aria-controls="government" aria-selected="false"
									class="my_btn nav-link border-0 text-uppercase font-weight-bold">government
									bus</a>
							</li>
						</ul>

						<div id="myTabContent" class="tab-content">

							<div id="private" role="tabpanel" aria-labelledby="private-tab"
								class="tab-pane fade px-4 py-5 show active">
								<!-- repreating element -->
								<div class="row list-bus animated fadeInUp" ng-repeat="bus in buses">
									<!-- details -->
									<div class="col-md-2 icon px-md-5">
										<img src="images/icon/buses.png" alt="busicon">
									</div>
									<div class="col-md-3">
										<p>
											<b>
												{{bus.operatorName}}
											</b>
										</p>
										<p>
											{{bus.busType}}
										</p>
									</div>
									<div class="col-md-3">
										<p>
											<span>
												{{bus.departureTime}}
											</span>
											<i class="fa fa-arrow-right px-2" aria-hidden="true"></i>
											<span>
												{{bus.arrivalTime}}
											</span>
										</p>
										<p style="color: #007bff; font-weight: 500;">
											Boarding & Dropping point
										</p>
									</div>
									<div class="col-md-2">
										<img src="images/icon/passenger.png" alt="passengericon">
										<p>
											<span>{{bus.availableSeats}}</span> Seats
										</p>
									</div>
									<div class="col-md-2">
										<p style="font-size: 2rem;"><b>₹{{getFare(bus)}}</b></p>
										<button id="seats" class="btn btn-info info-btn text-uppercase">View
											Seats</button>
									</div>

									<!-- bus layout -->
									<!-- <div class="col-md-12" style="border: 1px solid black;">
										<h1>
											bus layout
										</h1>
										<button id="sl" onclick="generateLayout()">Click me</button>
										<div>
										</div>
									</div> -->
								</div>
							</div>

							<div id="government" role="tabpanel" aria-labelledby="government-tab"
								class="tab-pane fade px-4 py-5">
								<!-- repreating element -->
								<div class="row list-bus animated fadeInUp">
									<div class="col-md-2 icon px-md-5">
										<img src="images/icon/buses.png" alt="busicon">
									</div>
									<div class="col-md-3">
										<p>
											<b>
												Classic Travels
											</b>
										</p>
										<p>
											A/C Sleeper (2+1)
										</p>
									</div>
									<div class="col-md-3">
										<p>
											<span>
												11:30 PM
											</span>
											<i class="fa fa-arrow-right px-2" aria-hidden="true"></i>
											<span>
												05:30 AM
											</span>
										</p>
										<p style="color: #007bff; font-weight: 500;">
											Boarding & Dropping point
										</p>
									</div>
									<div class="col-md-2">
										<img src="images/icon/passenger.png" alt="passengericon">
										<p>
											<span>40</span> Seats
										</p>
									</div>
									<div class="col-md-2">
										<p><b>₹6,050</b></p>
										<button class="btn btn-info info-btn text-uppercase">View Seats</button>
									</div>
								</div>
							</div>

						</div>
						<!-- End rounded tabs -->
					</div>
				</div>
			</div>

			<div class="col-md-3 px-3 animated slideInRight">
				<div class="jumbotron jumbotron-fluid" id="detail_form">
					<div class="container">
						<form>
							<div class="form-group font-weight-bold">
								<label for="name">Name</label>
								<input type="text" class="form-control" id="name" aria-describedby="name"
									placeholder="Enter Full Name">
							</div>
							<div class="form-group font-weight-bold">
								<label for="mobile">Mobile</label>
								<input type="number" class="form-control" id="mobile" aria-describedby="mobile"
									placeholder="Enter Mobile Number">
								<!-- <small id="mobile" class="form-text text-muted">We'll never share your email with
									anyone else.</small> -->
							</div>
							<div class="form-group font-weight-bold">
								<label for="boardingpoint">Boarding point</label>
								<select id="boardingpoint" class="form-control">
									<option selected>Choose...</option>
									<option>...</option>
								</select>
							</div>
							<div class="form-group font-weight-bold">
								<label for="droppingpoint">Dropping point</label>
								<select id="droppingpoint" class="form-control">
									<option selected>Choose...</option>
									<option>...</option>
								</select>
							</div>
							<hr>
							<p><b>Fare Deatils</b></p>
							<div class="container-fluid">
								<div class="row">
									<div class="col-md-12">
										<p class="lead">Amount <span
												class="lead font-weight-bold float-right">₹6,050</span></p>
									</div>
									<div class="col-md-12">
										<small class="text-muted">Taxes will be calculated during payment</small>
									</div>
									<input type="text" class="mt-2 form-control" id="cupon" aria-describedby="mobile"
										placeholder="Enter Coupon Code">
								</div>
							</div>
							<br>
							<button class="btn btn-success text-uppercase btn-block">Proceed to Payment</button>
						</form>
					</div>
				</div>
			</div>
		</div>
		<div class="row wrapper" id="Error_part">
			<h1>
				Sorry No buses on this route!
			</h1>
		</div>
	</div>

	<!-- Modal -->
	<div class="modal fade" id="elegantModalForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
		aria-hidden="true">
		<div class="modal-dialog" role="document">
			<!--Content-->
			<div class="modal-content form-elegant">
				<!--Header-->
				<div class="modal-header text-center">
					<h3 class="modal-title w-100 dark-grey-text font-weight-bold my-3" id="myModalLabel"><strong
							style="text-shadow: 2px 2px grey;font-size: 2.5rem;">Log
							In</strong></h3>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<!--Body-->
				<div class="modal-body mx-4">
					<!--Body-->
					<div class="md-form mb-5">
						<input type="email" id="Form-email1" class="form-control validate" placeholder="Your email">
					</div>

					<div class="md-form pb-3">
						<input type="password" id="Form-pass1" class="form-control validate"
							placeholder="Your password">
						<br>
						<p class="font-small blue-text d-flex justify-content-end">Forgot <a href="#"
								class="blue-text ml-1">
								Password?</a></p>
					</div>

					<div class="text-center mb-3">
						<button type="button" class="btn blue-gradient btn-block z-depth-1a">Sign
							in</button>
					</div>
					<p class="font-small dark-grey-text text-right d-flex justify-content-center mb-3 pt-2"> or Sign in
						with:</p>

					<div class="row my-3 d-flex justify-content-around">
						<!--Facebook-->
						<button type="button" class="btn btn-white  z-depth-1a"><i class="fa fa-facebook py-2 px-4"
								aria-hidden="true"></i></button>
						<!--Google -->
						<button type="button" class="btn btn-white  z-depth-1a"><i class="fa fa-google py-2 px-4"
								aria-hidden="true"></i></button>
					</div>
				</div>
				<!--Footer-->
				<div class="modal-footer mx-5 pt-3 mb-1">
					<p class="font-small grey-text d-flex justify-content-end">Not a member? <a href="#"
							class="blue-text ml-1">
							Sign Up</a></p>
				</div>
			</div>
			<!--/.Content-->
		</div>
	</div>
	<!-- Modal -->

	<!-- Button calling modal -->
	<div class="text-center" style="display: none;">
		<a href="" id="login_modal" class="btn btn-default btn-rounded" data-toggle="modal"
			data-target="#elegantModalForm">Launch
			modal Login Form</a>
	</div>

	<!-- footer -->
	<div class="footer">
		<p class="text-center">
			© 2020 MilePartner . All Rights Reserved
		</p>
	</div>

	<!--========= Scripts ===========-->
	<script src="js/angularjs.js"></script>
	<script src="js/jquery-latest.min.js"></script>
	<script src="js/jquery-ui.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js">
	</script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js">
	</script>

	<script>
		// boilerplate fo page
		$('#to').datepicker({
			dateFormat: 'yy-mm-dd'
		});
		$(document).ready(function () {
			$("#detail_form").hide();
			$("#list_part").hide();
			$("#Error_part").hide();
		});
		$('#seats').click(function () {
			$("#detail_form").fadeIn();
		})

		// angular code
		var app = angular.module("myApp", []);
		app.controller("myCtrl", function ($scope, $http, $location) {
			
			// url extraction
			var url = $location.absUrl().split('?')[1];
			var para = url.split('&')
			var sourceCity = para[0].split('=')[1];
			var destinationCity =para[1].split('=')[1];
			var doj =para[2].split('=')[1];
			
			var data;
			
			// call for bus list
			$http.get("http://localhost:3000/api/bus/getAvailableBuses?sourceCity="+sourceCity+"&destinationCity="+destinationCity+"&doj="+doj)
			.then(function (response) {
				data = response.data.apiAvailableBuses;
				if (data === null) {
					$("#loader_part").fadeOut("slow");
					$('#Error_part').fadeIn("slow");
				} else {
					$scope.buses = data;
					$scope.getFare = function (bus) {
						var one = bus.fare.split(',')
						one[0] = parseInt(one[0]);
						one[1] = parseInt(one[1]);
						return Math.min(...one)
					}
					$("#loader_part").fadeOut("slow");

					setTimeout(function () {
						console.log("response came");
						$('#list_part').fadeIn("fast");
					}, 500);

					// setTimeout(function () {
					// 	console.log("login Pls");
					// 	$('#login_modal').click();
					// }, 10000);
				}	
			  })
		})
	</script>
</body>

</html>