<!DOCTYPE html>
<html lang="en">

<head>
	<title>Mile Partner -All Buses</title>
	<!--== META TAGS ==-->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<!-- FAV ICON -->
	<link rel="shortcut icon" href="images/fav.ico">
	<!-- FONT-AWESOME ICON CSS -->
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<!--== ALL CSS FILES ==-->
	<link rel="stylesheet" href="css/bus.css">
	<link rel="stylesheet" href="css/animate.css">
	<link rel="stylesheet" href="css/datepicker.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
	<link rel="stylesheet" href="css/mycss.css">
	<link rel="stylesheet" href="css/flashy.min.css">
	<link rel="stylesheet" href="css/my-radio.css">
	<style>
		/* loader */
		.wrapper{
			width: 100%;
			height: 80vh;
			margin:0;
			padding: 0;
			display: flex;
			justify-content: center;
			align-items: center;
		}
		.wrapper2{
			width: 100%;
			height: 50vh;
			margin:0;
			padding: 0;
			display: flex;
			justify-content: center;
			align-items: center;
		}
		.wrapper3{
			width: 100%;
			margin:0;
			padding: 0;
			display: flex;
			justify-content: center;
			align-items: center;
		}
		.wrapper h1,.wrapper2 h1{
			text-shadow:1px 1px crimson;
			font-size: 3.5rem;
		}
		.loader {
			border: 16px solid #3498db;
			border-radius: 50%;
			border-top: 16px solid crimson;
			width: 100px;
			height: 100px;
			-webkit-animation: spin 2s linear infinite; /* Safari */
			animation: spin 2s linear infinite;
		}

		.loader2 {
			border: 8px solid #3498db;
			border-radius: 50%;
			border-top: 8px solid crimson;
			width: 50px;
			height: 50px;
			-webkit-animation: spin 2s linear infinite; /* Safari */
			animation: spin 2s linear infinite;
		}
		
		/* Safari */
		@-webkit-keyframes spin {
			0% { -webkit-transform: rotate(0deg); }
			100% { -webkit-transform: rotate(360deg); }
		}
		
		@keyframes spin {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		}

		/* moadal */
		.form-elegant .font-small {
			font-size: 0.8rem;
		}

		.form-elegant .z-depth-1a {
			-webkit-box-shadow: 0 2px 5px 0 rgba(55, 161, 255, 0.26), 0 4px 12px 0 rgba(121, 155, 254, 0.25);
			box-shadow: 0 2px 5px 0 rgba(55, 161, 255, 0.26), 0 4px 12px 0 rgba(121, 155, 254, 0.25);
		}

		.form-elegant .z-depth-1-half,
		.form-elegant .btn:hover {
			-webkit-box-shadow: 0 5px 11px 0 rgba(85, 182, 255, 0.28), 0 4px 15px 0 rgba(36, 133, 255, 0.15);
			box-shadow: 0 5px 11px 0 rgba(85, 182, 255, 0.28), 0 4px 15px 0 rgba(36, 133, 255, 0.15);
		}

		.form-elegant .modal-header {
			border-bottom: none;
		}

		.modal-dialog .form-elegant .btn .fab {
			color: #2196f3 !important;
		}

		.form-elegant .modal-body,
		.form-elegant .modal-footer {
			font-weight: 400;
		}

		.blue-gradient {
			color: white;
			background: linear-gradient(to right, rgb(36, 141, 202), rgb(56, 63, 197));
			text-transform: uppercase;
			border-radius: 50px !important;
		}

		.blue-gradient:hover {
			background: linear-gradient(to right, rgb(56, 63, 197), rgb(36, 141, 202));
		}

		.btn-white {
			background-color: #ffffff !important;
			color: #2196f3 !important;
			border-radius: 50px !important;
		}

		.md-form input {
			border: none;
			border-bottom: 1px solid #2196f3 !important;
			border-radius: 0px !important;
			color: #2196f3 !important;
		}
	</style>
</head>

<body ng-app="myApp" ng-controller="myCtrl">
	<!-- NAVBAR-->
	<nav class="navbar navbar-expand-lg navbar-light shadow-sm" style="background-color: #ffffff !important;">
		<div class="container">
			<a href="index.html" class="navbar-brand">
				<!-- Logo Image -->
				<img src="images/logo_org.png" width="110px" alt="" class="d-inline-block align-middle">

			</a>
			<button type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
				aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"
				class="navbar-toggler"><span class="navbar-toggler-icon"></span></button>

			<div id="navbarSupportedContent" class="collapse navbar-collapse">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
					<li class="nav-item"><a href="print-cancel.html" class="nav-link">Print/Cancel Ticket</a></li>					
					<li class="nav-item"><a href="#" class="nav-link">Contact us</a></li>
				</ul>
			</div>
		</div>
	</nav>		
	<!-- Main content -->
	<div class="container-fluid">
		<div class="row wrapper" id="loader_part">
			<div class="loader"></div>
		</div>
		<div class="row p-2" id="list_part">
			<div class="col-md-9" style="padding-right: 0px !important;">

				<!-- filter -->
				<div class="container-fluid">
					<div class="row text-center filter mt-3 animated fadeIn">
						<div class="col-md-3 mb-2">
							<button type="button" class="btn btn-danger" id="prev_btn"> 
								<i class="fa fa-arrow-left" aria-hidden="true"></i> Prev. Day
							</button>
						</div>
						<div class="col-md-6 mb-2">
							<div class="input-group">
								<input type="text" class="form-control" id="to" placeholder="Date (yy-mm-dd)" aria-label="Recipient's username" aria-describedby="basic-addon2">
								<div class="input-group-append">
									<button class="btn btn-info" id="to_btn" type="button">GO</button>
								</div>
							</div>
						</div>
						<div class="col-md-3">
							<button type="button" class="btn btn-danger" id="next_btn">Next Day 
								<i class="fa fa-arrow-right" aria-hidden="true"></i>
							</button>
						</div>
					</div>
				</div>
				<!-- filter end -->
				<div class="pt-4 wow fadeInUp" data-wow-duration="0.7s">
					<div class=" rounded shadow m-2">
						<!-- Rounded tabs -->
						<ul id="myTab" role="tablist"
							class="nav nav-tabs nav-pills flex-column flex-sm-row justify-content-around border-0 rounded-nav animated fadeInUp">
							<li class="nav-item flex-sm-fill">
								<a id="private-tab" data-toggle="tab" href="#private" role="tab" aria-controls="private"
									aria-selected="true"
									class="my_btn nav-link border-0 text-uppercase font-weight-bold active">Private
									Bus</a>
							</li>
							<li class="nav-item flex-sm-fill">
								<a id="government-tab" data-toggle="tab" href="#government" role="tab"
									aria-controls="government" aria-selected="false"
									class="my_btn nav-link border-0 text-uppercase font-weight-bold">government
									bus</a>
							</li>
						</ul>

						<div id="myTabContent" class="tab-content">

							<div id="private" role="tabpanel" aria-labelledby="private-tab"
								class="tab-pane fade px-4 py-5 show active">
								<!-- repreating element -->
								<div class="row list-bus animated fadeInUp mb-4" style="border-radius: 12px;" id="pri" ng-repeat="bus in priBus">
									<!-- details -->
									<div class="col-md-2 icon px-md-5">
										<img src="images/icon/buses.png" alt="busicon">
									</div>
									<div class="col-md-3">
										<p>
											<b>
												{{bus.operatorName}}
											</b>
										</p>
										<p>
											{{bus.busType}}
										</p>
									</div>
									<div class="col-md-3">
										<p>
											<span>
												{{bus.departureTime}}
											</span>
											<i class="fa fa-arrow-right px-2" aria-hidden="true"></i>
											<span>
												{{bus.arrivalTime}}
											</span>
										</p>
										<button class="btn btn-outline-primary" ng-click="do_some($index)">
											Boarding & Dropping point
										</button>
										<!-- <a class="bd_btn" style="color: #007bff; font-weight: 500;">
											Boarding & Dropping point
										</a> -->
									</div>
									<div class="col-md-2">
										<img src="images/icon/passenger.png" alt="passengericon">
										<p>
											<span>{{bus.availableSeats}}</span> Seats
										</p>
									</div>
									<div class="col-md-2">
										<p style="font-size: 2rem;"><b>â‚¹{{getFare(bus)}}</b></p>
										<button id="seats" ng-click="layout($index,bus.inventoryType,bus.routeScheduleId,bus.cancellationPolicy)" class="btn btn-info info-btn text-uppercase">
											View Seats
										</button>
									</div>

									<!-- tables for boarding and droping points -->
									<div class="col-md-6 mt-4 animated fadeIn" id="div_{{$index}}" style="font-size: 1rem !important;display: none;">
										<table class="table">
											<thead class="thead-light">
												<tr>
													<th scope="col">Timing</th>
													<th scope="col">Points</th>
												</tr>
											</thead>
											<tbody>
												<tr ng-repeat="point in bus.boardingPoints">
													<td>{{point.time}}</td>
													<td>{{point.location}}</td>
												</tr>
											</tbody>
										</table>
									</div>
									<div class="col-md-6 mt-4 animated fadeIn" id="div__{{$index}}" style="font-size: 1rem !important;display: none;">
										<table class="table">
											<thead class="thead-light">
												<tr>
													<th scope="col">Timing</th>
													<th scope="col">Points</th>
												</tr>
											</thead>
											<tbody>
												<tr ng-repeat="point in bus.droppingPoints">
													<td>{{point.time}}</td>
													<td>{{point.location}}</td>
												</tr>
											</tbody>
										</table>
									</div>

									<!-- bus layout -->
									<div class="col-md-12 my-5 animated fadeIn" id="div_loader_{{$index}}" style="display: none;">
										<div class="wrapper3">
											<div class="loader2"></div>
										</div>
									</div>
									<div class="col-md-4 my-5 animated fadeIn" id="bus_layout_info_{{$index}}" style="display: none;">
										<ul style="list-style: none; padding: 0px !important; font-size: 1.25rem;">
											<li><img src="images/bus_seat/available.png" alt="pic" style="width: 15px; height: 15px;"> <span style="margin-left: 10px ;">Available</span></li>
											<li><img src="images/bus_seat/women.png" alt="pic" style="width: 15px; height: 15px;"><span style="margin-left: 10px ;">Available for female</span></li>
											<li><img src="images/bus_seat/booked.png" alt="pic" style="width: 15px; height: 15px;"><span style="margin-left: 10px ;">Booked</span></li>
											<li><img src="images/bus_seat/select.png" alt="pic" style="width: 15px; height: 15px;"><span style="margin-left: 10px ;">Selected</span></li>
											<li><img src="images/bus_seat/not_available.png" alt="pic" style="width: 15px; height: 15px;"><span style="margin-left: 10px ;">Not Available</span></li>
										</ul>
										<!-- <hr> -->
										<table class="table" style="font-size: 1rem !important;">
											<thead class="thead-light">
												<tr>
													<th scope="col">Cut off Time</th>
													<th scope="col">Refund In Percentage</th>
												</tr>
											</thead>
											<tbody>
												<tr ng-repeat="x in refund_list">
													<td>{{x.cutoffTime}} hr</td>
													<td>{{x.refundInPercentage}}%</td>
												</tr>
											</tbody>
										</table>
									</div>
									<div class="col-md-8 my-5 animated fadeIn" id="bus_layout_{{$index}}" style="display: none;">
									</div>
									<!-- button for proceed -->
									<div class="col-md-12 animated fadeIn" id="bus_layout_proceed_{{$index}}" style="display: none;">
										<a class="btn btn-success float-right text-light" id="proceed_to_form" ng-click="bus_form($index,bus)">PROCEED</a>
									</div>

								</div>

							<!-- error part pri. bus -->
								<div class="row wrapper2" id="Error_pri">
									<h1>
										Sorry No Private buses on this route!
									</h1>
								</div>
							</div>

							<div id="government" role="tabpanel" aria-labelledby="government-tab"
								class="tab-pane fade px-4 py-5">
								<!-- repreating element -->
								<div class="row list-bus animated fadeInUp mb-4"  style="border-radius: 12px;"  id="pri" ng-repeat="bus in govBus">
									<!-- details -->
									<div class="col-md-2 icon px-md-5">
										<img src="images/icon/buses.png" alt="busicon">
									</div>
									<div class="col-md-3">
										<p>
											<b>
												{{bus.operatorName}}
											</b>
										</p>
										<p>
											{{bus.busType}}
										</p>
									</div>
									<div class="col-md-3">
										<p>
											<span>
												{{bus.departureTime}}
											</span>
											<i class="fa fa-arrow-right px-2" aria-hidden="true"></i>
											<span>
												{{bus.arrivalTime}}
											</span>
										</p>
										<button class="btn btn-outline-primary" ng-click="do_some_2_($index)">
											Boarding & Dropping point
										</button>
										<!-- <a class="bd_btn" style="color: #007bff; font-weight: 500;">
											Boarding & Dropping point
										</a> -->
									</div>
									<div class="col-md-2">
										<img src="images/icon/passenger.png" alt="passengericon">
										<p>
											<span>{{bus.availableSeats}}</span> Seats
										</p>
									</div>
									<div class="col-md-2">
										<p style="font-size: 2rem;"><b>â‚¹{{getFare(bus)}}</b></p>
										<button id="seats_2" ng-click="layout_2($index,bus.inventoryType,bus.routeScheduleId,bus.cancellationPolicy)" class="btn btn-info info-btn text-uppercase">
											View Seats
										</button>
									</div>

									<!-- tables for boarding and droping points -->
									<div class="col-md-6 mt-4 animated fadeIn" id="div_2_{{$index}}" style="font-size: 1rem !important;display: none;">
										<table class="table">
											<thead class="thead-light">
												<tr>
													<th scope="col">Timing</th>
													<th scope="col">Points</th>
												</tr>
											</thead>
											<tbody>
												<tr ng-repeat="point in bus.boardingPoints">
													<td>{{point.time}}</td>
													<td>{{point.location}}</td>
												</tr>
											</tbody>
										</table>
									</div>
									<div class="col-md-6 mt-4 animated fadeIn" id="div__2_{{$index}}" style="font-size: 1rem !important;display: none;">
										<table class="table">
											<thead class="thead-light">
												<tr>
													<th scope="col">Timing</th>
													<th scope="col">Points</th>
												</tr>
											</thead>
											<tbody>
												<tr ng-repeat="point in bus.droppingPoints">
													<td>{{point.time}}</td>
													<td>{{point.location}}</td>
												</tr>
											</tbody>
										</table>
									</div>

									<!-- bus layout -->
									<div class="col-md-12 my-5 animated fadeIn" id="div_loader_2_{{$index}}" style="display: none;">
										<div class="wrapper3">
											<div class="loader2"></div>
										</div>
									</div>
									<div class="col-md-4 my-5 animated fadeIn" id="bus_layout_info_2_{{$index}}" style="display: none;">
										<ul style="list-style: none; padding: 0px !important; font-size: 1.25rem;">
											<li><img src="images/bus_seat/available.png" alt="pic" style="width: 15px; height: 15px;"> <span style="margin-left: 10px ;">Available</span></li>
											<li><img src="images/bus_seat/women.png" alt="pic" style="width: 15px; height: 15px;"><span style="margin-left: 10px ;">Available for female</span></li>
											<li><img src="images/bus_seat/booked.png" alt="pic" style="width: 15px; height: 15px;"><span style="margin-left: 10px ;">Booked</span></li>
											<li><img src="images/bus_seat/select.png" alt="pic" style="width: 15px; height: 15px;"><span style="margin-left: 10px ;">Selected</span></li>
											<li><img src="images/bus_seat/not_available.png" alt="pic" style="width: 15px; height: 15px;"><span style="margin-left: 10px ;">Not Available</span></li>
										</ul>
										<!-- <hr> -->
										<table class="table" style="font-size: 1rem !important;">
											<thead class="thead-light">
												<tr>
													<th scope="col">Cut off Time</th>
													<th scope="col">Refund In Percentage</th>
												</tr>
											</thead>
											<tbody>
												<tr ng-repeat="x in refund_list">
													<td>{{x.cutoffTime}} hr</td>
													<td>{{x.refundInPercentage}}%</td>
												</tr>
											</tbody>
										</table>
									</div>
									<div class="col-md-8 my-5 animated fadeIn" id="bus_layout_2_{{$index}}" style="display: none;">
									</div>
									<!-- button for proceed -->
									<div class="col-md-12 animated fadeIn" id="bus_layout_proceed_2_{{$index}}" style="display: none;">
										<!-- proceed btn -->
										<a class="btn btn-success float-right text-light" id="proceed_to_form_2" ng-click="bus_form_2($index,bus)">PROCEED</a>
									</div>
								</div>

								<!-- error gov. bus -->
								<div class="row wrapper2" id="Error_gov">
									<h1>
										Sorry No Government buses on this route!
									</h1>
								</div>
							</div>

						</div>
						<!-- End rounded tabs -->
					</div>
				</div>
			</div>

			<!-- form to fill -->
			
			<div class="col-md-3 px-3 mt-md-5 animated slideInRight" id="detail_form" style="display: none;">
				<div class="jumbotron jumbotron-fluid" style="background-color: #f8f9fa !important; border-radius: 12px;">
					<div class="container">
						<form>
							<!-- repeating elements -->
							<div class="form-group font-weight-bold" ng-repeat="person in persons">
								<h6 class="text-bold"><b><u>Passenger No : {{$index+1}}</u></b></h6>
								<br>
								<!-- name -->
								<label for="name">Name</label>
								<input type="text" class="form-control" id="name_{{$index}}" aria-describedby="name"
									placeholder="Enter Full Name">
								<br>
								<!-- age -->
								<label for="age">Age</label>
								<input type="number" class="form-control" id="age_{{$index}}" aria-describedby="age"
									placeholder="Enter Age">
								<br>
								<!-- gender -->
								<label for="boardingpoint">Gender</label>
								<select id="gender_{{$index}}" class="form-control">
									<option selected>Choose...</option>
									<option>Male</option>
									<option>Female</option>
									<option>Other</option>
								</select>
								<hr>
							</div>

							<!-- bording and droping points -->
							<div class="form-group font-weight-bold">
								<label for="boardingpoint">Boarding point</label>
								<select id="boardingpoint" class="form-control">
									<option selected></option>
									<option ng-repeat="x in that_bus.boardingPoints">{{x.location}}</option>
								</select>
							</div>
							<div class="form-group font-weight-bold">
								<label for="droppingpoint">Dropping point</label>
								<select id="droppingpoint" class="form-control">
									<option selected></option>
									<!-- change here to droping its bording for test period -->
									<option ng-repeat="x in that_bus.boardingPoints">{{x.location}}</option> 
								</select>
							</div>
							<hr>
							<!-- Fare details -->
							<p><b>Fare Deatils</b></p>
							<div class="container-fluid">
								<div class="row">
									<div class="col-md-12">
										<p class="lead">Amount vaibhav <span class="lead font-weight-bold float-right">â‚¹6,050</span></p>
										<small class="text-muted" style="font-size: 0.75rem;">Taxes will be calculated during payment</small>
									</div>
								</div>
								<div class="my-4">
									<p class="lead"><small><b>Available Cupons</b></small></p>
									<label style="font-size: 1rem !important;" class="container2"><i class="fa fa-tags" aria-hidden="true"></i> WINTERCAB <small class="float-right">(â‚¹ 23255)</small>
										<input type="radio" value="WINTERCAB" checked name="discount">
										<span class="checkmark"></span>
									</label>
									<label style="font-size: 1rem !important;" class="container2"><i class="fa fa-tags" aria-hidden="true"></i> CABFV <small class="float-right">(â‚¹ 23255)</small>
										<input type="radio" name="discount"  value="CABFV">
										<span class="checkmark"></span>
									</label>
								</div>
								<div class="input-group my-2">
									<input type="text" class="form-control" placeholder="Enter Coupon Code">
									<div class="input-group-append">
									  <button class="btn btn-primary">Apply</button>
									</div>
								</div>
							</div>
							<br>
							<button type="submit" class="btn btn-success text-uppercase btn-block" ng-click="obj_making()">Proceed to Payment</button>
						</form>
					</div>
				</div>
			</div>
		</div>
		<div class="row wrapper" id="Error_part">
			<h1>
				Sorry No buses on this route!
			</h1>
		</div>
	</div>

	<!-- Modal -->
	<div class="modal fade" id="elegantModalForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
		aria-hidden="true">
		<div class="modal-dialog" role="document">
			<!--Content-->
			<div class="modal-content form-elegant">
				<!--Header-->
				<div class="modal-header text-center">
					<h3 class="modal-title w-100 dark-grey-text font-weight-bold my-3" id="myModalLabel"><strong
							style="text-shadow: 2px 2px grey;font-size: 2.5rem;">Log
							In</strong></h3>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<!--Body-->
				<div class="modal-body mx-4">
					<!--Body-->
					<div class="md-form mb-5">
						<input type="email" id="Form-email1" class="form-control validate" placeholder="Your email">
					</div>

					<div class="md-form pb-3">
						<input type="password" id="Form-pass1" class="form-control validate"
							placeholder="Your password">
						<br>
						<p class="font-small blue-text d-flex justify-content-end">Forgot <a href="#"
								class="blue-text ml-1">
								Password?</a></p>
					</div>

					<div class="text-center mb-3">
						<button type="button" class="btn blue-gradient btn-block z-depth-1a">Sign
							in</button>
					</div>
					<p class="font-small dark-grey-text text-right d-flex justify-content-center mb-3 pt-2"> or Sign in
						with:</p>

					<div class="row my-3 d-flex justify-content-around">
						<!--Facebook-->
						<button type="button" class="btn btn-white  z-depth-1a"><i class="fa fa-facebook py-2 px-4"
								aria-hidden="true"></i></button>
						<!--Google -->
						<button type="button" class="btn btn-white  z-depth-1a"><i class="fa fa-google py-2 px-4"
								aria-hidden="true"></i></button>
					</div>
				</div>
				<!--Footer-->
				<div class="modal-footer mx-5 pt-3 mb-1">
					<p class="font-small grey-text d-flex justify-content-end">Not a member? <a href="#"
							class="blue-text ml-1">
							Sign Up</a></p>
				</div>
			</div>
			<!--/.Content-->
		</div>
	</div>
	<!-- Modal -->

	<!-- Button calling modal -->
	<div class="text-center" style="display: none;">
		<a href="" id="login_modal" class="btn btn-default btn-rounded" data-toggle="modal"
			data-target="#elegantModalForm">Launch
			modal Login Form</a>
	</div>

	<!-- footer -->
	<div class="footer">
		<p class="text-center">
			Â© 2020 MilePartner . All Rights Reserved
		</p>
	</div>

	<!--========= Scripts ===========-->
	<script src="js/angularjs.js"></script>
	<script src="js/jquery-latest.min.js"></script>
	<script src="js/jquery-ui.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

	<script src ="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js" ></script>
	<script src="js/bus-layout.js"></script>
	<script src="js/generator.js"></script>
	<script src="js/flashy.min.js"></script>


	<script>
		// boilerplate fo page
		$('#to').datepicker({
			dateFormat: 'yy-mm-dd'
		});
		$(document).ready(function () {
			$("#list_part").hide();
			$("#Error_part").hide();
		});
		// $('#seats').click(function () {
		// 	$("#detail_form").fadeIn();
		// })

		// angular code starts
		var app = angular.module("myApp", []);
		app.controller("myCtrl", function ($scope, $http, $location) {
			
			// url extraction
			var url = $location.absUrl().split('?')[1];
			var para = url.split('&')
			var sourceCity = para[0].split('=')[1];
			var destinationCity =para[1].split('=')[1];
			var doj =para[2].split('=')[1];
			$("#to").val(doj) //setting val of dateinput from query parameters

			var data;
			var apiUrl = "http://localhost:3000/api/bus/getAvailableBuses?sourceCity="+sourceCity+"&destinationCity="+destinationCity+"&doj=";
			var newUrl;
			// call for bus list
			$http.get(apiUrl+doj)
			.then(function (response) {
				data = response.data.apiAvailableBuses;
				if (data === null) {
					$("#loader_part").fadeOut("slow");
					$('#Error_part').fadeIn("slow");
				} else {
					
					$scope.priBus = []; //length 0 the no pri bus
					$scope.govBus= []; //length 0 the no gov bus
					// seperating private and gov buses
					angular.forEach(data, function (value, key) { 
		                if (!value.isRTC) {
							$scope.priBus.push(value); 
						}
            		}); 
					angular.forEach(data, function (value, key) { 
		                if (!value.isRTC) {
							$scope.govBus.push(value); 
						}
            		}); 

					// hiding no bus part and tables
					if ($scope.priBus.length) {
						$('#Error_pri').hide();
					}
					if ($scope.govBus.length) {
						$('#Error_gov').hide();
					}

					// returns min fare
					$scope.getFare = function (bus) {
						var one = bus.fare.split(',')
						one[0] = parseInt(one[0]);
						one[1] = parseInt(one[1]);
						return Math.min(...one)
					}
					$("#loader_part").fadeOut("slow");

					setTimeout(function () {
						console.log("response came and list shown");
						$('#list_part').fadeIn("fast");
					}, 500);

					//login modal after 10sec of user serfing 
					// setTimeout(function () {
					// 	console.log("login Pls");
					// 	$('#login_modal').click();
					// }, 10000);

				}	
			  })

			//   datechanged new url hit from mid calaender tab
			$('#to_btn').click(function () {
				let newDate = $('#to').val();
				newUrl = $location.absUrl().split('?')[0]+"?sourceCity="+sourceCity+"&destinationCity="+destinationCity+"&doj="+newDate;
				if (newDate.length == 10) {
					window.location.href = newUrl;
				}
				else{
					console.log("error in date")
				}
			})

			// prev. day btn
			$('#prev_btn').click(function () {	
				var temp = doj.split("-");	
				var add = parseInt(temp[2])-1;
				let newDate = temp[0]+"-"+temp[1]+"-"+add 
				newUrl = $location.absUrl().split('?')[0]+"?sourceCity="+sourceCity+"&destinationCity="+destinationCity+"&doj="+newDate;
				if (newDate.length == 10) {
					window.location.href = newUrl;
				}
				else{
					console.log("error in date")
				}
			})
			
			// next day btn
			$('#next_btn').click(function () {
				var temp = doj.split("-");	
				var add = parseInt(temp[2])+1;
				let newDate = temp[0]+"-"+temp[1]+"-"+add 
				newUrl = $location.absUrl().split('?')[0]+"?sourceCity="+sourceCity+"&destinationCity="+destinationCity+"&doj="+newDate;
				if (newDate.length == 10) {
					window.location.href = newUrl;
				}
				else{
					console.log("error in date")
				}
			})

			// toggle table droping and boarding points
			$scope.do_some = function (i) {
				var one = "#div_"+i;
				var two = "#div__"+i;
				$(one).toggle();
				$(two).toggle();
			}
			$scope.do_some_2_ = function (i) {
				var one = "#div_2_"+i;
				var two = "#div__2_"+i;
				$(one).toggle();
				$(two).toggle();
			}

			// refund calculation
			var refund_calc = function (str) {
				var obj = JSON.parse(str);
				$scope.refund_list = obj;
				// console.log(typeof(obj));
				// console.log(obj)
			}

			// bus layout call
			$scope.layout = function (i,iT,rsH,str) {
				refund_calc(str);
				var apiUrl2 = "http://localhost:3000/api/bus/getBusLayout?sourceCity="+sourceCity+"&destinationCity="+destinationCity+"&doj=";
				if(doj.length > 10)
				{
					var temp = doj.split('#')[0];
					let loader = "#div_loader_"+i
					let info = "#bus_layout_info_"+i
					let layout = "#bus_layout_"+i
					let proceed = "#bus_layout_proceed_"+i

					// console.log(apiUrl2+temp+"&inventoryType="+iT+"&routeScheduleId="+rsH);

					// managing layout hide and show along with api call
					if ($(layout).is(":visible")) 
					{
						$(layout).toggle();
						$(info).toggle();
						$(proceed).toggle();
					} else {	
							$(loader).toggle();				
							// calling layout API
							$http.get(apiUrl2+temp+"&inventoryType="+iT+"&routeScheduleId="+rsH)
								.then(function (response) {
									$(loader).toggle();
									var seats = response.data.seats
									var seatLayout=checkZ(seats,rsH);
									$(layout).html(" ");
									$(layout).append(seatLayout);

									$(layout).toggle();
									$(info).toggle();
									$(proceed).toggle();

									console.log("layout came and displayed")
								})
					}
					
				}
				else{
					// console.log(apiUrl2+doj+"&inventoryType="+iT+"&routeScheduleId="+rsH);

					let loader = "#div_loader_"+i
					let info = "#bus_layout_info_"+i
					let layout = "#bus_layout_"+i
					let proceed = "#bus_layout_proceed_"+i
					// managing layout hide and show along with api call

					if ($(layout).is(":visible")) 
					{
						$(layout).toggle();
						$(info).toggle();
						$(proceed).toggle();
						
					} else {

						$(loader).toggle();
						// calling layout API
						$http.get(apiUrl2+doj+"&inventoryType="+iT+"&routeScheduleId="+rsH)
							.then(function (response) {
								$(loader).toggle();
								var seats = response.data.seats
								var seatLayout=checkZ(seats,rsH);
								$(layout).html(" ");
								$(layout).append(seatLayout);

								$(layout).toggle();
								$(info).toggle();
								$(proceed).toggle();

								console.log("layout came and displayed")
							})
					}

				}
			}

			$scope.layout_2 = function (i,iT,rsH,str) {
				refund_calc(str);
				var apiUrl2 = "http://localhost:3000/api/bus/getBusLayout?sourceCity="+sourceCity+"&destinationCity="+destinationCity+"&doj=";
				if(doj.length > 10)
				{
					var temp = doj.split('#')[0];
					let loader = "#div_loader_2_"+i
					let info = "#bus_layout_info_2_"+i
					let layout = "#bus_layout_2_"+i
					let proceed = "#bus_layout_proceed_2_"+i

					// console.log(apiUrl2+temp+"&inventoryType="+iT+"&routeScheduleId="+rsH);

					// managing layout hide and show along with api call
					if ($(layout).is(":visible")) 
					{
						$(layout).toggle();
						$(info).toggle();
						$(proceed).toggle();
					} else {	
							$(loader).toggle();				
							// calling layout API
							$http.get(apiUrl2+temp+"&inventoryType="+iT+"&routeScheduleId="+rsH)
								.then(function (response) {
									$(loader).toggle();
									var seats = response.data.seats
									var seatLayout=checkZ(seats,rsH);
									$(layout).html(" ");
									$(layout).append(seatLayout);

									$(layout).toggle();
									$(info).toggle();
									$(proceed).toggle();

									console.log("layout came and displayed")
								})
					}
					
				}
				else{
					// console.log(apiUrl2+doj+"&inventoryType="+iT+"&routeScheduleId="+rsH);

					let loader = "#div_loader_2_"+i
					let info = "#bus_layout_info_2_"+i
					let layout = "#bus_layout_2_"+i
					let proceed = "#bus_layout_proceed_2_"+i
					// managing layout hide and show along with api call

					if ($(layout).is(":visible")) 
					{
						$(layout).toggle();
						$(info).toggle();
						$(proceed).toggle();
						
					} else {

						$(loader).toggle();
						// calling layout API
						$http.get(apiUrl2+doj+"&inventoryType="+iT+"&routeScheduleId="+rsH)
							.then(function (response) {
								$(loader).toggle();
								var seats = response.data.seats
								var seatLayout=checkZ(seats,rsH);
								$(layout).html(" ");
								$(layout).append(seatLayout);

								$(layout).toggle();
								$(info).toggle();
								$(proceed).toggle();

								console.log("layout came and displayed")
							})
					}

				}
			}

			// bus proceed form 
			$scope.bus_form = function (i,that_bus) {
				$scope.persons = bookedSeats; //total seats
				$scope.that_bus = that_bus; // for borading and droping points
				// console.log($scope.persons)
				
				var width = $(window).width();
				// console.log(width);
				
				if ($scope.persons.length == 0) {
					flashy("Please Select a Seat",{
					timeout: 3000
					});
					return;
				}

				if (width <= 480) {
					flashy('Please scroll to Bottom to fill the form.',{
						stop : true,
						type : "flashy__warning"
					});
				}
				else{
					flashy('Please scroll to top to fill the form.',{
  					stop : true,
					type : "flashy__warning"
				});
				}

				// form showing
				if ($("#detail_form").is(":visible")) {
					$("#detail_form").fadeOut("fast");
				}
				else{
					$("#detail_form").toggle();
				}
			}
			
			$scope.bus_form_2 = function (i,that_bus) {
				$scope.persons = bookedSeats; //total seats
				$scope.that_bus = that_bus; // for borading and droping points
				// console.log($scope.persons)
				
				var width = $(window).width();
				// console.log(width);
				
				if ($scope.persons.length == 0) {
					flashy("Please Select a Seat",{
					timeout: 3000
					});
					return;
				}

				if (width <= 480) {
					flashy('Please scroll to Bottom to fill the form.',{
						timeout: 3000,
						type : "flashy__warning"
					});
					setTimeout(() => {
						flashy('For Government Buses Ticket Price May Change During Payment.',{
							stop : true,
							type : "flashy__info"
					});
					}, 3500);
				}
				else{
					flashy('Please scroll to top to fill the form.',{
						timeout: 3000,
						type : "flashy__warning"
					});
					setTimeout(() => {
						flashy('For Government Buses Ticket Price May Change During Payment.',{
							stop : true,
							type : "flashy__info"
					});
					}, 3500);
				}

				// form showing
				if ($("#detail_form").is(":visible")) {
					$("#detail_form").fadeOut("fast");
				}
				else{
					$("#detail_form").toggle();
				}
			}


			// obj making
			$scope.obj_making = function () {
				var num_passenger = bookedSeats.length;
				var obj = {
					boardingPoints: $('#boardingpoint').val(),
					droppingPoints: $('#droppingpoint').val(),
					seatInfo : [],
					state: "state",
					country: "country"
				};
				for (let i = 0; i < num_passenger; i++) {
					var n = "#name_"+i;
					var a = "#age_"+i;
					var g = "#gender_"+i;
					var s = bookedSeats[i];
					var temp = {
						name : $(n).val(),
						age: $(n).val(),
						gender: $(n).val(),
						seatId : s
					};
					obj.seatInfo.push(temp)
				}
				if (obj.boardingPoints.length != 0 && obj.droppingPoints.length != 0 && obj.seatInfo.length != 0 && obj.state.length != 0 && obj.country.length != 0) {
					console.log(obj)
				}
				else{
					alert("fill complete form")
				}
			}

		})
		// angular code ends
	</script>
</body>

</html>